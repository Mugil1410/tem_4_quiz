<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Team 4 Quiz Spinner</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<style>
body {
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, #f6d365, #fda085);
    font-family: 'Poppins', sans-serif;
    overflow: hidden;
}

/* Welcome Card */
#welcome-card {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(15px);
    border-radius: 25px;
    padding: 40px 30px;
    text-align: center;
    box-shadow: 0 8px 32px rgba(0,0,0,0.25);
    width: 400px;
    max-width: 90%;
    color: #fff;
    z-index: 20;
}
#welcome-card h1 { font-size: 32px; font-weight: bold; margin-bottom: 15px; }
#welcome-card p { font-size: 20px; margin-bottom: 20px; }
#emojis { display: flex; justify-content: center; gap: 15px; font-size: 36px; margin-bottom: 20px; }
#welcome-card button { width: 100%; font-weight: bold; }

/* Spinner Wrapper */
#wrapper {
    display: none;
    position: relative;
    width: 70vw;
    max-width: 600px;
    height: 70vw;
    max-height: 600px;
}

/* Wheel */
#wheel {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 8px solid #fff;
    overflow: hidden;
    position: relative;
    transition: transform 5s cubic-bezier(0, .99, .44, .99);
}
.slice {
    width: 50%;
    height: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform-origin: 0% 0%;
    clip-path: polygon(0 0, 100% 0, 100% 50%);
    display: flex;
    justify-content: flex-end;
    align-items: flex-start;
}
.slice span {
    position: absolute;
    top: 8%;
    left: 70%;
    transform: translateX(-50%) rotate(24deg);
    transform-origin: center;
    color: #fff;
    font-weight: bold;
    font-size: calc(16px + 0.5vw);
}

/* Spin Button */
#spin {
    width: 35%;
    aspect-ratio: 1;
    border-radius: 50%;
    background: #fff;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-weight: bold;
    z-index: 10;
    font-size: calc(36px + 0.5vw);
}

/* Selector Triangle pointing to top */
#selector {
    position: absolute;
    top: -4%;
    left: 50%;
    transform: translateX(-50%) rotate(180deg);
    width: 0;
    height: 0;
    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-bottom: 30px solid red;
    z-index: 15;
}

/* Question Card */
#question-card, #result-card {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255,255,255,0.2);
    backdrop-filter: blur(15px);
    border-radius: 20px;
    padding: 30px 20px;
    width: 450px;
    max-width: 90%;
    color: #fff;
    text-align: center;
    box-shadow: 0 8px 32px rgba(0,0,0,0.25);
    z-index: 30;
}
.option-btn { width: 100%; margin: 8px 0; font-weight: bold; }

footer {
    position: absolute;
    bottom: 15px;
    width: 100%;
    text-align: center;
    font-size: 16px;
    color: #555;
}

</style>
</head>
<body>

<!-- Welcome Card -->
<div id="welcome-card">
    <h1>Welcome to <strong>Team 4 Quiz</strong>!</h1>
    <div id="emojis">
        <span>üß†</span>
        <span>‚ùì</span>
        <span>üéØ</span>
    </div>
    <p>Get ready! <strong>15 Questions</strong> await you.</p>
    <button class="btn btn-warning btn-lg" id="start-btn">Start Quiz</button>
</div>

<!-- Spinner Wrapper -->
<div id="wrapper">
    <div id="selector"></div>
    <div id="wheel"></div>
    <div id="spin">SPIN</div>
</div>

<!-- Question Card -->
<div id="question-card">
    <h3 id="question-text"></h3>
    <div id="options"></div>
    <button class="btn btn-primary mt-3" id="spin-again">Spin Again</button>
</div>

<!-- Result Card -->
<div id="result-card">
    <h2 id="result-msg"></h2>
    <p id="score-msg"></p>
    <div id="confetti-container"></div>
</div>

<footer>
    By:Aishwarya Jain, Nivedha MP, Kanmani S, Shivani, Janani A, Kaviya Sritha
</footer>

<!-- Add this in <head> or before your main script -->
<script src="../questions.js"></script>

<script>


let remainingNumbers = Array.from({length:15},(_,i)=>i);
let score = 0;

// Wheel
const wheel = document.getElementById('wheel');
const colors = ["#e74c3c","#e67e22","#f1c40f","#2ecc71","#1abc9c","#3498db","#9b59b6","#34495e","#f39c12","#d35400","#c0392b","#16a085","#8e44ad","#2980b9","#7f8c8d"];
const slices = 15;

// Create slices
for(let i=0;i<slices;i++){
    let div=document.createElement('div');
    div.className='slice';
    div.style.background=colors[i];
    div.style.transform=`rotate(${i*(360/slices)}deg)`;
    div.innerHTML=`<span style="transform: rotate(${360/slices/2}deg)">${i+1}</span>`;
    wheel.appendChild(div);
}

// Start quiz
$('#start-btn').click(()=>$('#welcome-card').fadeOut(800,()=>$('#wrapper').fadeIn(800)));

let degree = 1800;
let clicks = 0;

// Spin wheel
$('#spin').click(function(){
    if(remainingNumbers.length===0){showResult(); return;}
    clicks++;
    let extra = Math.floor(Math.random()*360)+1;
    let totalDegree = degree*clicks + extra;
    $('#wheel').css('transform',`rotate(${totalDegree}deg)`);

    setTimeout(()=>{
        // Get slice at top
        let finalRotation = totalDegree % 360;
        let sliceAngle = 360/slices;
        let selected = slices - Math.floor(finalRotation/sliceAngle);
        let idx = selected % slices;

        while(!remainingNumbers.includes(idx)){
            idx = (idx-1+slices)%slices;
        }
        remainingNumbers = remainingNumbers.filter(n=>n!==idx);

        showQuestion(idx);
    },5000);
});

// Show question
// show question
function showQuestion(num){
    $('#wrapper').fadeOut(500, ()=>{
        const q = questions[num];  // uses external questions.js array
        $('#question-text').text(q.q);
        $('#options').empty();

        q.o.forEach((opt, i)=>{
            let btn = $(`<button class="btn btn-light option-btn">${opt}</button>`);
            btn.click(function(){
                $('.option-btn').attr('disabled', true);
                if(i === q.a){
                    $(this).removeClass('btn-light').addClass('btn-success');
                    score++;
                } else {
                    $(this).removeClass('btn-light').addClass('btn-danger');
                    $('.option-btn').each(function(idx){
                        if(idx === q.a) $(this).removeClass('btn-light').addClass('btn-success');
                    });
                }
            });
            $('#options').append(btn);
        });

        $('#question-card').fadeIn(500);
    });
}


// Spin again
$('#spin-again').click(()=>{
    $('#question-card').fadeOut(500,()=>{
        if(remainingNumbers.length>0) $('#wrapper').fadeIn(500);
        else showResult();
    });
});

// Show result
function showResult(){
    $('#wrapper').fadeOut(500);
    $('#question-card').fadeOut(500);
    $('#result-card').fadeIn(500);
    $('#score-msg').text(`You answered ${score} out of 15 questions correctly!`);
    let msg = '';
    if(score===15) msg="üéâ Perfect Score! Amazing! üéâ";
    else if(score>=10) msg="üëç Great Job! Keep it up!";
    else if(score>=5) msg="üôÇ Good effort! Try again!";
    else msg="üò¢ Better luck next time!";
    $('#result-msg').text(msg);

    // Restart Quiz
    $('#restart-btn').click(()=>{
        remainingNumbers = Array.from({length:15},(_,i)=>i);
        score = 0;
        clicks = 0;
        $('#result-card').fadeOut(500, ()=>{
            $('#wrapper').fadeIn(500);
        });
    });
}
</script>
</body>
</html>
